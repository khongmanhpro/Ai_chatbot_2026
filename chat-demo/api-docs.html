<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Documentation - LightRAG Insurance</title>
    <link rel="stylesheet" href="style.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap"
        rel="stylesheet">
    <style>
        .docs-container {
            max-width: 1000px;
            margin: 2rem auto;
            padding: 2rem;
            background: white;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
        }

        .docs-header {
            border-bottom: 2px solid var(--gray-200);
            padding-bottom: 1.5rem;
            margin-bottom: 2rem;
        }

        .docs-header h1 {
            color: var(--primary-blue);
            margin-bottom: 0.5rem;
        }

        .docs-section {
            margin-bottom: 3rem;
        }

        .docs-section h2 {
            color: var(--gray-900);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--gray-200);
        }

        .docs-section h3 {
            color: var(--primary-blue);
            margin: 1.5rem 0 1rem;
        }

        .endpoint {
            background: var(--gray-50);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .endpoint-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .method {
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-sm);
            font-weight: 600;
            font-size: 0.875rem;
        }

        .method.post {
            background: var(--success-green);
            color: white;
        }

        .method.get {
            background: var(--primary-blue);
            color: white;
        }

        .endpoint-url {
            font-family: 'Fira Code', monospace;
            font-size: 1rem;
            color: var(--gray-700);
        }

        .code-block {
            background: var(--gray-900);
            color: #e5e7eb;
            padding: 1.5rem;
            border-radius: var(--radius-md);
            overflow-x: auto;
            margin: 1rem 0;
            position: relative;
        }

        .code-block code {
            font-family: 'Fira Code', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
        }

        .copy-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 0.8125rem;
            transition: all var(--transition-base);
        }

        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .param-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .param-table th,
        .param-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--gray-200);
        }

        .param-table th {
            background: var(--gray-50);
            font-weight: 600;
            color: var(--gray-700);
        }

        .param-table code {
            background: var(--gray-100);
            padding: 0.125rem 0.375rem;
            border-radius: var(--radius-sm);
            font-family: 'Fira Code', monospace;
            font-size: 0.875rem;
            color: var(--primary-blue);
        }

        .badge {
            display: inline-block;
            padding: 0.125rem 0.5rem;
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 500;
        }

        .badge.required {
            background: #fee2e2;
            color: #991b1b;
        }

        .badge.optional {
            background: #dbeafe;
            color: #1e40af;
        }

        .alert {
            padding: 1rem;
            border-radius: var(--radius-md);
            margin: 1rem 0;
            border-left: 4px solid;
        }

        .alert.info {
            background: #dbeafe;
            border-color: var(--primary-blue);
            color: #1e3a8a;
        }

        .alert.warning {
            background: #fef3c7;
            border-color: var(--warning-yellow);
            color: #78350f;
        }

        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: var(--gradient-primary);
            color: white;
            border-radius: var(--radius-md);
            text-decoration: none;
            font-weight: 500;
            transition: all var(--transition-base);
            margin-bottom: 2rem;
        }

        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
    </style>
</head>

<body>
    <div class="docs-container">
        <a href="index.html" class="back-btn">‚Üê Quay l·∫°i Chat</a>

        <div class="docs-header">
            <h1>üìö T√†i Li·ªáu API - LightRAG Insurance</h1>
            <p>H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng API cho chatbot b·∫£o hi·ªÉm v·ªõi LightRAG</p>
        </div>

        <!-- Authentication -->
        <section class="docs-section">
            <h2>üîê X√°c Th·ª±c (Authentication)</h2>
            <p>API y√™u c·∫ßu x√°c th·ª±c qua <strong>API Key</strong>. Th√™m header sau v√†o m·ªçi request:</p>

            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code>X-API-Key: your_api_key_here</code>
            </div>

            <div class="alert info">
                <strong>üí° L∆∞u √Ω:</strong> API key ƒë∆∞·ª£c c·∫•u h√¨nh trong file <code>.env</code> c·ªßa server. Li√™n h·ªá admin
                ƒë·ªÉ l·∫•y API key.
            </div>
        </section>

        <!-- Query Endpoint -->
        <section class="docs-section">
            <h2>üì° Endpoints</h2>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method post">POST</span>
                    <span class="endpoint-url">/query/stream</span>
                </div>

                <p><strong>M√¥ t·∫£:</strong> G·ª≠i c√¢u h·ªèi v√† nh·∫≠n ph·∫£n h·ªìi d·∫°ng streaming (real-time)</p>

                <h3>Request Body</h3>
                <table class="param-table">
                    <thead>
                        <tr>
                            <th>Tham s·ªë</th>
                            <th>Ki·ªÉu</th>
                            <th>B·∫Øt bu·ªôc</th>
                            <th>M√¥ t·∫£</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>query</code></td>
                            <td>string</td>
                            <td><span class="badge required">Required</span></td>
                            <td>C√¢u h·ªèi c·ªßa ng∆∞·ªùi d√πng</td>
                        </tr>
                        <tr>
                            <td><code>mode</code></td>
                            <td>string</td>
                            <td><span class="badge optional">Optional</span></td>
                            <td>Ch·∫ø ƒë·ªô query: <code>mix</code>, <code>hybrid</code>, <code>local</code>,
                                <code>global</code>, <code>naive</code><br>M·∫∑c ƒë·ªãnh: <code>mix</code></td>
                        </tr>
                        <tr>
                            <td><code>stream</code></td>
                            <td>boolean</td>
                            <td><span class="badge optional">Optional</span></td>
                            <td>B·∫≠t streaming response. M·∫∑c ƒë·ªãnh: <code>true</code></td>
                        </tr>
                        <tr>
                            <td><code>top_k</code></td>
                            <td>integer</td>
                            <td><span class="badge optional">Optional</span></td>
                            <td>S·ªë l∆∞·ª£ng k·∫øt qu·∫£ t·ªëi ƒëa. M·∫∑c ƒë·ªãnh: <code>60</code></td>
                        </tr>
                        <tr>
                            <td><code>only_need_context</code></td>
                            <td>boolean</td>
                            <td><span class="badge optional">Optional</span></td>
                            <td>Ch·ªâ tr·∫£ context kh√¥ng c√≥ LLM response. M·∫∑c ƒë·ªãnh: <code>false</code></td>
                        </tr>
                    </tbody>
                </table>

                <h3>Response Format (Streaming)</h3>
                <p>Server tr·∫£ v·ªÅ <strong>Server-Sent Events (SSE)</strong> v·ªõi format:</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>data: {"type": "text", "data": "chunk n·ªôi dung..."}<br>data: {"type": "done"}</code>
                </div>

                <h3>V√≠ d·ª•: cURL</h3>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>curl -X POST http://localhost:9621/query/stream \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your_api_key" \
  -d '{
    "query": "B·∫£o hi·ªÉm xe m√°y l√† g√¨?",
    "mode": "mix",
    "stream": true,
    "top_k": 60
  }'</code>
                </div>

                <h3>V√≠ d·ª•: JavaScript (Fetch API)</h3>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>const response = await fetch('http://localhost:9621/query/stream', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'X-API-Key': 'your_api_key'
  },
  body: JSON.stringify({
    query: 'B·∫£o hi·ªÉm xe m√°y l√† g√¨?',
    mode: 'mix',
    stream: true,
    top_k: 60
  })
});

const reader = response.body.getReader();
const decoder = new TextDecoder();

while (true) {
  const { done, value } = await reader.read();
  if (done) break;
  
  const chunk = decoder.decode(value);
  const lines = chunk.split('\\n');
  
  for (const line of lines) {
    if (line.startsWith('data: ')) {
      const data = JSON.parse(line.slice(6));
      if (data.type === 'text') {
        console.log(data.data);
      }
    }
  }
}</code>
                </div>

                <h3>V√≠ d·ª•: Python (requests)</h3>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>import requests
import json

url = "http://localhost:9621/query/stream"
headers = {
    "Content-Type": "application/json",
    "X-API-Key": "your_api_key"
}
data = {
    "query": "B·∫£o hi·ªÉm xe m√°y l√† g√¨?",
    "mode": "mix",
    "stream": True,
    "top_k": 60
}

response = requests.post(url, headers=headers, json=data, stream=True)

for line in response.iter_lines():
    if line.startswith(b'data: '):
        chunk = json.loads(line[6:])
        if chunk['type'] == 'text':
            print(chunk['data'], end='', flush=True)</code>
                </div>
            </div>

            <!-- Health Endpoint -->
            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method get">GET</span>
                    <span class="endpoint-url">/health</span>
                </div>

                <p><strong>M√¥ t·∫£:</strong> Ki·ªÉm tra tr·∫°ng th√°i server v√† c·∫•u h√¨nh</p>

                <h3>Response Example</h3>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>{
  "status": "healthy",
  "configuration": {
    "llm_binding": "openai",
    "llm_model": "gpt-4",
    "embedding_binding": "openai",
    "embedding_model": "text-embedding-3-small"
  }
}</code>
                </div>
            </div>
        </section>

        <!-- Query Modes -->
        <section class="docs-section">
            <h2>üéØ Ch·∫ø ƒê·ªô Query (Query Modes)</h2>

            <table class="param-table">
                <thead>
                    <tr>
                        <th>Mode</th>
                        <th>M√¥ t·∫£</th>
                        <th>Khi n√†o d√πng</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>mix</code></td>
                        <td>K·∫øt h·ª£p local + global query (khuy·∫øn ngh·ªã)</td>
                        <td>ƒêa s·ªë tr∆∞·ªùng h·ª£p, c√¢u h·ªèi ph·ª©c t·∫°p</td>
                    </tr>
                    <tr>
                        <td><code>hybrid</code></td>
                        <td>K·∫øt h·ª£p vector search + keyword search</td>
                        <td>C√¢n b·∫±ng gi·ªØa ƒë·ªô ch√≠nh x√°c v√† ƒë·ªô bao ph·ªß</td>
                    </tr>
                    <tr>
                        <td><code>local</code></td>
                        <td>T√¨m ki·∫øm theo entities v√† relations g·∫ßn nh·∫•t</td>
                        <td>C√¢u h·ªèi c·ª• th·ªÉ v·ªÅ m·ªôt ch·ªß ƒë·ªÅ</td>
                    </tr>
                    <tr>
                        <td><code>global</code></td>
                        <td>T√¨m ki·∫øm theo to√†n b·ªô knowledge graph</td>
                        <td>C√¢u h·ªèi t·ªïng quan, so s√°nh nhi·ªÅu lo·∫°i b·∫£o hi·ªÉm</td>
                    </tr>
                    <tr>
                        <td><code>naive</code></td>
                        <td>Vector search ƒë∆°n gi·∫£n</td>
                        <td>Testing, c√¢u h·ªèi ƒë∆°n gi·∫£n</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Error Codes -->
        <section class="docs-section">
            <h2>‚ö†Ô∏è M√£ L·ªói (Error Codes)</h2>

            <table class="param-table">
                <thead>
                    <tr>
                        <th>Status Code</th>
                        <th>M√¥ t·∫£</th>
                        <th>Gi·∫£i ph√°p</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>401</code></td>
                        <td>Unauthorized - Thi·∫øu ho·∫∑c sai API key</td>
                        <td>Ki·ªÉm tra header X-API-Key</td>
                    </tr>
                    <tr>
                        <td><code>400</code></td>
                        <td>Bad Request - Thi·∫øu tham s·ªë b·∫Øt bu·ªôc</td>
                        <td>Ki·ªÉm tra request body</td>
                    </tr>
                    <tr>
                        <td><code>500</code></td>
                        <td>Internal Server Error</td>
                        <td>Ki·ªÉm tra server logs, li√™n h·ªá admin</td>
                    </tr>
                    <tr>
                        <td><code>503</code></td>
                        <td>Service Unavailable</td>
                        <td>Server ƒëang b·∫≠n ho·∫∑c maintenance</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Best Practices -->
        <section class="docs-section">
            <h2>‚ú® Best Practices</h2>

            <h3>1. Timeout Settings</h3>
            <p>Streaming responses c√≥ th·ªÉ m·∫•t 10-30 gi√¢y. ƒê·∫∑t timeout ph√π h·ª£p:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code>// JavaScript
fetch(url, { 
  signal: AbortSignal.timeout(120000) // 2 minutes
})</code>
            </div>

            <h3>2. Error Handling</h3>
            <p>Lu√¥n x·ª≠ l√Ω l·ªói v√† hi·ªÉn th·ªã th√¥ng b√°o th√¢n thi·ªán:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code>try {
  const response = await queryAPI(query);
  // Process response
} catch (error) {
  if (error.status === 401) {
    alert('Vui l√≤ng ki·ªÉm tra API key');
  } else {
    alert('ƒê√£ x·∫£y ra l·ªói, vui l√≤ng th·ª≠ l·∫°i');
  }
}</code>
            </div>

            <h3>3. Rate Limiting</h3>
            <div class="alert warning">
                <strong>‚ö†Ô∏è L∆∞u √Ω:</strong> ƒê·ªÉ tr√°nh qu√° t·∫£i server, n√™n gi·ªõi h·∫°n s·ªë request li√™n ti·∫øp. ƒê·ªÅ xu·∫•t: T·ªëi ƒëa
                10 queries/ph√∫t/user.
            </div>
        </section>

        <!-- Contact -->
        <section class="docs-section">
            <h2>üìû Li√™n H·ªá & H·ªó Tr·ª£</h2>
            <p>N·∫øu g·∫∑p v·∫•n ƒë·ªÅ ho·∫∑c c·∫ßn h·ªó tr·ª£:</p>
            <ul>
                <li>üìß Email: dev-team@company.com</li>
                <li>üìù GitHub Issues: <a href="https://github.com/HKUDS/LightRAG" target="_blank">LightRAG
                        Repository</a></li>
                <li>üìö Documentation: <a href="http://localhost:9621/docs" target="_blank">Swagger API Docs</a></li>
            </ul>
        </section>
    </div>

    <script>
        function copyCode(button) {
            const codeBlock = button.nextElementSibling;
            const text = codeBlock.textContent;

            navigator.clipboard.writeText(text).then(() => {
                button.textContent = '‚úì Copied!';
                setTimeout(() => {
                    button.textContent = 'Copy';
                }, 2000);
            });
        }
    </script>
</body>

</html>